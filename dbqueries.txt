//creating a database
create database if not exists `phpcrudappdb`;

//using this db
use `phpcrudappdb`;

//creating a user to connect to this db
create user `adminuser`@`localhost` identified BY 'adminpassword';

//check grants status for the current user
SHOW GRANTS FOR `adminuser`@`localhost`;

//providing grants to the DB users
GRANT ALL ON `phpcrudappdb`.`admintable` TO `adminuser`@`localhost`;   
SHOW GRANTS FOR `adminuser`@`localhost`;


//creating the admintable
create table `admintable`(
    adminid int not null AUTO_INCREMENT,
    adminname varchar(255),
    adminemail varchar(255),
    adminpassword varchar(255),
    adminrole varchar(255),
    PRIMARY KEY (adminid)
    );


//creating usertable


//inserting into admin table
insert into `phpcrudappdb`.`admintable`(adminname,adminemail,adminpassword,adminrole) VALUES('adminaman','adminaman@gmail.com','amanpass','admin'); 
insert into `phpcrudappdb`.`admintable`(adminname,adminemail,adminpassword,adminrole) VALUES('adminanisha','adminanisha@gmail.com','anishapass','admin'); 
insert into `phpcrudappdb`.`admintable`(adminname,adminemail,adminpassword,adminrole) VALUES('adminayaz','adminayaz@gmail.com','ayazpass','admin'); 


UPDATE `phpcrudappdb`.`admintable` SET `adminemail` = 'pandiaaman16@gmail.com' where `adminname` = 'adminaman';

//GRANTing permissions to usertable
GRANT ALL ON `phpcrudappdb`.`usertable` TO `adminuser`@`localhost`;
SHOW GRANTS FOR `adminuser`@`localhost`;

//inserting into user table
INSERT INTO usertable(userfirstname,userlastname,username,usergender,useremail,userage,userpassword) VALUES('ayaz','zargham','zarghamayaz','M','ayazargham@gmail.com','23','password');


//error type:
Fatal error: Uncaught PDOException: SQLSTATE[42000]: Syntax error or access violation: 1142 SELECT command denied to user 'adminuser'@'localhost' for table `phpcrudappdb`.`usertable` in C:\xampp\htdocs\PHPMYSQL_CRUD_app\PHPMYSQL_CRUD_app\userlogin.php:21 Stack trace: #0 C:\xampp\htdocs\PHPMYSQL_CRUD_app\PHPMYSQL_CRUD_app\userlogin.php(21): PDOStatement->execute(Array) #1 {main} thrown in C:\xampp\htdocs\PHPMYSQL_CRUD_app\PHPMYSQL_CRUD_app\userlogin.php on line 21
//to resolve, we grant access
GRANT ALL ON `phpcrudappdb`.`usertable` TO `adminuser`@`localhost`; 